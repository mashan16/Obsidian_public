## Что такое iostat

Утилита `iostat` — это инструмент командной строки в **Linux**, используемый для **мониторинга и составления отчетов об активности ЦП, дискового ввода / вывода и блочных устройств**. Эта программа особенно полезна для системных администраторов, так как позволяет провести анализ производительности системы, выявление узких мест и оптимизацию использования ресурсов.  

## Установка iostat в Linux

По умолчанию этот инструмент не предустановлен в большинстве популярных дистрибутивов **Linux**. Для его установки Вам понадобится соответствующий менеджер пакетов. Для **Debian / Ubuntu**:

```
sudo apt install sysstat
```

## Использование iostat

Утилита `iostat` имеет свои опции, с помощью которых пользователь может настроить список характеристик, выводимых на экран. Однако, `iostat` может использоваться и без них — достаточно ввести следующую команду:

```
iostat
```

[![iostat](https://blog.sedicomm.com/wp-content/uploads/2017/07/iostat-1024x576.jpg)](https://blog.sedicomm.com/wp-content/uploads/2017/07/iostat.jpg)

**Читайте также:**[Glances — инструмент мониторинга системы в реальном времени для Linux](https://blog.sedicomm.com/2020/02/13/glances-instrument-monitoringa-sistemy-v-realnom-vremeni-dlya-linux/).

По умолчанию `iostat` отображает два блока статистики: **о работе процессора** и **о различных устройствах**. Раздел о ЦП содержит следующую **информацию в виде таблицы**, в которой:
- `%user` — показывает процент использования ЦП обычным пользователем;
- `%nice` — отображает процент использования процессора пользователем с низким приоритетом;
- `%system` — показывает процент использования ЦП, задействованный на уровне системы (ядра);
- `%iowait` — показывает процент времени, в течение которого процессор простаивал, и система имела невыполненный запрос ввода / вывода на диск;
- `%steal` — отображает процент времени, проведенного виртуальным процессором в ожидании, пока гипервизор обслуживал другой виртуальный процессор;
- `%idle` — показывает процент времени, в течение которого процессор простаивал, а система не имела невыполненных запросов ввода / вывода с диска.

Второй раздел выходных данных содержит **отчет об использовании устройств**, в котором:
- `Device` — имя устройства или раздела в каталоге `/dev`;
- `tps` — число передач в секунду, которые были выданы устройству;
- `Blk_read/s` — количество данных, прочитанных с устройства, выраженное в количестве блоков (килобайт, мегабайт) в секунду;
- `Blk_wrtn/s` — количество данных, записанных на устройство, выраженное в количестве блоков (килобайты, мегабайты) в секунду;
- `Blk_read` — общее количество прочитанных блоков;
- `Blk_wrtn` — общее количество записанных блоков.

У пользователя есть возможность **вывести на экран отдельно каждый из этих разделов**.
### Отобразите только статистику активности процессора

Чтобы отобразить на экране **статистику о работе ЦП**, используйте вместе с командой параметр `-c`:

```
iostat -c
```
[![iostat-c](https://blog.sedicomm.com/wp-content/uploads/2017/07/iostat-c-1024x576.jpg)](https://blog.sedicomm.com/wp-content/uploads/2017/07/iostat-c.jpg)  
### Отобразите только отчет об использовании устройств
Для вывода на экран **информации о работе устройств ввода / вывода и разделов диска**, введите вместе с `iostat` опцию `-d`:
```
iostat -d
```
[![iostat-d](https://blog.sedicomm.com/wp-content/uploads/2017/07/iostat-d-1024x576.jpg)](https://blog.sedicomm.com/wp-content/uploads/2017/07/iostat-d.jpg)

Вы также можете выбрать одно или несколько устройств **для мониторинга в реальном времени**. Для этого в предыдущей команде нужно перечислить их названия через пробелы, и в конце указать **время обновления в секундах**. Например, мы хотим отслеживать работу устройств `sda` и `sdb` с получением новой информации через каждые пять секунд:
```
iostat -d sda sdb 5
```
[![sda-sdb](https://blog.sedicomm.com/wp-content/uploads/2017/07/sda-sdb-1024x576.jpg)](https://blog.sedicomm.com/wp-content/uploads/2017/07/sda-sdb.jpg)

**Читайте также:**[4 инструмента для мониторинга температуры CPU и GPU в Ubuntu](https://blog.sedicomm.com/2020/02/29/4-instrumenta-dlya-monitoringa-temperatury-cpu-i-gpu-v-ubuntu/).

На скриншоте видно, что `iostat` показывает статистику только об устройстве `sda`. Это значит, что `sdb` не был им обнаружен в нашей системе.  
### Выведите на экран краткую статистику активности процессора и устройств

Инструмент `iostat` может отображать **краткую статистику** об активности процессора и дискового ввода / вывода — опция `-s` предоставляет **сводный обзор производительности системы**. При использовании этого параметра утилита выводит на экран:

- среднее количество прерываний процессора в секунду;
- количество дисков в системе;
- количество прочитанных и записанных секторов;
- среднее время обслуживания ввода / вывода;
- процент времени, проведенного процессором в состоянии простоя или ожидания.

```
iostat -s
```
[![iostat-s](https://blog.sedicomm.com/wp-content/uploads/2017/07/iostat-s-1024x576.jpg)](https://blog.sedicomm.com/wp-content/uploads/2017/07/iostat-s.jpg)  

### Выведите на экран статистику в удобочитаемом формате
По умолчанию вся информация, которая предоставлена Вам **отображается в байтах**. Многим пользователям, особенно начинающим, очень сложно разобраться в этих числах. Вы можете перевести байты в килобайты, мегабайты и так далее. То есть, привести отчет об использовании ЦП в **удобочитаемый формат**. Для этого нужно включить опцию `-h`:

```
iostat -h
```
[![iostat-h](https://blog.sedicomm.com/wp-content/uploads/2017/07/iostat-h-1024x576.jpg)](https://blog.sedicomm.com/wp-content/uploads/2017/07/iostat-h.jpg)  
**Читайте также:**[Hegemon — приложение модульного системного мониторинга для Linux](https://blog.sedicomm.com/2019/09/25/hegemon-prilozhenie-modulnogo-sistemnogo-monitoringa-dlya-linux/).  

### Отобразите расширенную статистику дискового ввода / вывода
Ранее мы показали Вам, как отобразить обычные и сокращенные данные о работе устройств ввода / вывода. На самом деле инструмент `iostat` может собрать гораздо **больше данных для углубленной диагностики системы**. В этом пользователю поможет параметр `-x`:

```
iostat -x
```
[![iostat-x](https://blog.sedicomm.com/wp-content/uploads/2017/07/iostat-x-1024x576.jpg)](https://blog.sedicomm.com/wp-content/uploads/2017/07/iostat-x.jpg)

Чтобы получить более подробную информацию об утилите `iostat`, посетите ее справочную страницу:
```
man iostat
```